{% extends 'base.html.twig' %}

{% block title %} Compte {% endblock %}

{% block body_attributes %}
    {{ parent() }}
    class="bg-secondary"
{% endblock %}

{% block body %}
    <main class="page-wrapper">
        <!-- Navbar. Remove 'fixed-top' class to make the navigation bar scrollable with the page-->
       {% include ('pages/header/navbar.html.twig') %}
        <!-- Page content-->
        <div class="container py-5 mt-4 mt-lg-5 mb-lg-4 my-xl-5">
            <div class="row pt-sm-2 pt-lg-0">
                {% include 'pages/account/_sidebar.html.twig' %}
                <!-- Page content-->
                <div class="col-lg-9 pt-4 pb-2 pb-sm-4">
                    <h1 class="h2 mb-4">Mon compte</h1>
                    <!-- Basic info-->
                    <section class="card border-0 py-1 p-md-2 p-xl-3 p-xxl-4 mb-4">
                        <div class="card-body">
                            <div class="d-flex align-items-center mt-sm-n1 pb-4 mb-0 mb-lg-1 mb-xl-3">
                                <i class="ai-user text-primary lead pe-1 me-2"></i>
                                <h2 class="h4 mb-0">Informations générales</h2>
                                <a class="btn btn-sm btn-secondary ms-auto" href="{{ path('account_settings') }}">
                                    <i class="ai-edit ms-n1 me-2"></i>
                                    Modifier les informations
                                </a>
                            </div>
                            <div class="d-md-flex align-items-center">
                                <div class="d-sm-flex align-items-center">
                                    <div class="rounded-circle bg-size-cover bg-position-center flex-shrink-0"
                                         style="width: 80px; height: 80px;
                                         background-image: url( {{ asset('assets/img/site/default-avatar.png') }} );">
                                    </div>
                                    <div class="pt-3 pt-sm-0 ps-sm-3">
                                        <h3 class="h5 mb-2 text-capitalize">{{ app.user.firstname }} {{ app.user.lastname }}
                                            <i class="ai-circle-check-filled fs-base text-success ms-2"></i>
                                        </h3>
                                        <div class="text-muted fw-medium d-flex flex-wrap flex-sm-nowrap align-items-center">
                                            <div class="d-flex align-items-center me-3">
                                                <i class="ai-mail me-1"></i>
                                                {{ app.user.email }}
                                            </div>
                                            <div class="d-flex align-items-center text-nowrap"><i class="ai-map-pin me-1"></i>
                                                {{ app.user.city }}
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            <div class="row py-4 mb-2 mb-sm-3">
                                <div class="col-md-6 mb-4 mb-md-0">
                                    <table class="table mb-0">
                                        <tr>
                                            <td class="border-0 text-muted py-1 px-0">Téléphone</td>
                                            <td class="border-0 text-dark fw-medium py-1 ps-3">{{ app.user.phone }}</td>
                                        </tr>
                                        <tr>
                                            <td class="border-0 text-muted py-1 px-0">Niveau</td>
                                            {% if app.user.divingLevel is null %}
                                                <td class="border-0 text-dark fw-medium py-1 ps-3">Pas de niveau</td>
                                            {% else %}
                                                <td class="border-0 text-dark fw-medium py-1 ps-3">Niveau {{ app.user.divingLevel }}</td>
                                            {% endif %}
                                        </tr>
                                        <tr>
                                            <td class="border-0 text-muted py-1 px-0">Certificat</td>
                                            <td class="border-0 text-dark fw-medium py-1 ps-3">
                                                {% if app.user.certificateMedical is null %}
                                                    Pas de certificat
                                                {% else %}
                                                    {# TODO: Ajouter le lien vers le certificat médical pour le consulter #}
                                                    <a href="{{ asset('uploads/certificates/' ~ app.user.certificateMedical) }}"
                                                       target="_blank">Voir le certificat
                                                    </a>
                                                {% endif %}
                                            </td>
                                        </tr>
                                    </table>
                                </div>
                                {# --------------------------Composant Licence FFESSM------------------------ #}

                                <div class="col-md-6 d-md-flex justify-content-end">
                                    <div class="card w-100 rounded-0 bg-light" style="max-width: 212px;">
                                        <div class="mt-3">
                                            <img class="mx-auto d-block" src="{{ asset('assets/img/logo/logo-ffessm.png') }}" alt="Logo FFESSM">
                                            <p class="m-0 text-center text-primary" style="font-size: 5px">IMMERSION & EMOTION</p>
                                        </div>
                                        <div class="mt-3">
                                            <div class="text-uppercase text-primary bold h4 text-center">licence</div>
                                            <img class="d-block mx-auto" src="{{ asset('assets/img/site/compte/troll-qr-code.jpg') }}" width="50" alt="troll qr-code">
                                            <h2 class="h6 my-1 text-center">{{ app.user.fullname }}</h2>
                                            {% if app.user.divingLevel is null %}
                                                <div class="text-center my-1" style="font-size: 12px;">
                                                    <i class="ai-triangle-alert text-primary"></i> <!-- Icône pour le niveau débutant -->
                                                    <span class="text-primary" style="font-size: 12px; font-weight: 700; text-align: center">Plongeur débutant</span>
                                                </div>
                                            {% else %}
                                                <div class="text-center" style="font-size: 12px;">
                                                    {% if app.user.divingLevel == 1 %}
                                                        <i class="ai-star text-success"></i> <!-- Icône pour le niveau 1 -->
                                                    {% elseif app.user.divingLevel == 2 %}
                                                        <i class="ai-star text-primary"></i> <!-- Icône pour le niveau 2 -->
                                                        <i class="ai-star text-primary"></i> <!-- Icône pour le niveau 2 -->
                                                    {% elseif app.user.divingLevel == 3 %}
                                                        <i class="ai-star text-danger"></i> <!-- Icône pour le niveau expert -->
                                                        <i class="ai-star text-danger"></i> <!-- Icône pour le niveau expert -->
                                                        <i class="ai-star text-danger"></i> <!-- Icône pour le niveau expert -->
                                                    {% endif %}
                                                </div>
                                            {% endif %}
                                            <h3 style="font-size: 12px; font-weight: 700; text-align: center">{{ app.user.licence }}</h3>
                                            <hr>
                                        </div>
                                        <div class="card-footer">
                                            <div class="d-flex flex-column m-0" style="font-size: 12px">
                                                <span class="mx-auto" style="font-size: 9px">Club de plongée maubeugeois <br></span>
                                                <strong class="text-center" style="font-size: 10px">09590020</strong>
                                                <span class="mx-auto m-0" style="font-size: 9px">Piscine tournesol épinette</span>
                                                <strong class="text-center" style="font-size: 10px">59600 Maubeuge.</strong>
                                                <span class="mx-auto m-0" style="font-size: 9px">Tel: +33 3 27 65 03 72</span>
                                            </div>
                                        </div>
                                    </div>
                                </div>

                            </div>
                            <div class="alert alert-info d-flex mb-0" role="alert"><i class="ai-circle-info fs-xl"></i>
                                <div class="ps-2">En cas de problème, veuillez contacter le responsable du club.
                                    <a class="alert-link ms-1" href="{{ path('account_settings') }}">Allez dans les paramètres !</a></div>
                            </div>
                        </div>
                    </section>
                    <div class="row row-cols-1 row-cols-md-2 g-4 mb-4">
                        <!-- Address-->
                        <section class="col">
                            <div class="card h-100 border-0 py-1 p-md-2 p-xl-3 p-xxl-4">
                                <div class="card-body">
                                    <div class="d-flex align-items-center mt-sm-n1 pb-4 mb-1 mb-lg-2">
                                        <i class="ai-map-pin text-primary lead pe-1 me-2"></i>
                                        <h2 class="h4 mb-0">Adresse</h2>
                                        <a class="btn btn-sm btn-secondary ms-4" href="{{ path('account_settings') }}">
                                            <i class="ai-edit ms-n1 me-2"></i>
                                            Modifier l'adresse
                                        </a>
                                    </div>
                                    <div class="d-flex align-items-center pb-1 mb-2">
                                        <h3 class="h6 mb-0 me-3">Domicile</h3>
                                        <span class="badge bg-faded-primary text-primary">Principale</span>
                                    </div>
                                    <p class="mb-0">{{ app.user.address }},<br>{{ app.user.zipCode }} {{ app.user.city }}<br>France</p>
                                    <p class="fs-sm text-white text-center py-3 mb-0">Account menu </p>
                                </div>
                            </div>
                        </section>
                    </div>
                </div>
            </div>
        </div>
        <!-- Divider for dark mode only-->
        <hr class="d-none d-dark-mode-block">
        <!-- Sidebar toggle button-->
        <button class="d-lg-none btn btn-sm fs-sm btn-primary w-100 rounded-0 fixed-bottom"
                data-bs-toggle="offcanvas" data-bs-target="#sidebarAccount">
            <i class="ai-menu me-2"></i>Menu du compte</button>
    </main>
{% endblock %}
